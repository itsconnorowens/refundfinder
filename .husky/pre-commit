#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Scan for secrets
echo "ğŸ”’ Scanning for secrets..."
npm run scan:secrets

# Run linting
echo "ğŸ“ Checking code style..."
npm run lint

# Run type checking
echo "ğŸ”§ Checking TypeScript..."
npm run type-check

# Run tests
echo "ğŸ§ª Running tests..."
npm test

# Check documentation health if any .md files changed
if git diff --cached --name-only | grep -q "\.md$"; then
  echo "ğŸ“ Checking documentation..."
  ./scripts/check-docs.sh || {
    echo ""
    echo "âŒ Documentation check failed!"
    echo "See docs/DOCUMENTATION_GUIDELINES.md for help"
    exit 1
  }
fi

echo "âœ… All pre-commit checks passed!"
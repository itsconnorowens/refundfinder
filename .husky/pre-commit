#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🔍 Running pre-commit checks..."

# Scan for secrets
echo "🔒 Scanning for secrets..."
npm run scan:secrets

# Run linting
echo "📝 Checking code style..."
npm run lint

# Run type checking
echo "🔧 Checking TypeScript..."
npm run type-check

# Run tests
echo "🧪 Running tests..."
npm test

# Check documentation health if any .md files changed
if git diff --cached --name-only | grep -q "\.md$"; then
  echo "📝 Checking documentation..."
  ./scripts/check-docs.sh || {
    echo ""
    echo "❌ Documentation check failed!"
    echo "See docs/DOCUMENTATION_GUIDELINES.md for help"
    exit 1
  }
fi

echo "✅ All pre-commit checks passed!"